<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gallery</title>
<link rel="stylesheet" href="assets/reset.css">
<link rel="stylesheet" href="assets/common.css">
<link rel="stylesheet" href="assets/page.css">
<link rel="stylesheet" href="assets/gallery.css">

<style>
body {
	font-family: sans-serif;
}
</style>

</head>
<body>

<div id="root-container">__GENERATED_CONTENT__</div>

<script>

const listenerToPreventAnchorClick = function(ev) {
	if (document.getElementById('root-container').contains(ev.target)) {
		ev.preventDefault();
	}
};
document.addEventListener('click', listenerToPreventAnchorClick);

</script>
<script>
const INITIAL_DATA = __INITIAL_DATA__;
</script>
<script type="module">

import hydrate from "./js/lib/ts/dom/hydrate.js";
import Root from "./js/ts/gallery/components/Root.js";

const component = new Root(INITIAL_DATA);
component.setModifier(modifier);
component.setup();
console.log(component);
hydrate(component, document.getElementById('root-container').childNodes);
component.setupDom();

document.removeEventListener('click', listenerToPreventAnchorClick);

component.notifyAfterAttachToDom();

function getInitialData()
{
	const initialDataJSON = document.body.attributes.getNamedItem('data-initial-data').value;
	const initialData = JSON.parse(initialDataJSON);
	return initialData;
}

function modifier(component)
{
	if (component instanceof Root) {
		component.injectAttributes({
			apiBaseUrl: 'http://localhost/projects/image-api-symfony/public',
			initialData: INITIAL_DATA,
		});
	}
}

</script>

</body>
</html>
